import{i as C,k as L,r as m,l as D,m as j,n as F,j as s,L as R,o as z,p as G,a as V}from"./index-DXvaqpMq.js";import{s as f}from"./06.module-DnV--02W.js";const J={VITE_APP_Email06:"marco79mo@gmail.com",VITE_APP_Password06:"7533967",VITE_APP_Path06:"marcochiu"},{VITE_APP_Path06:B,VITE_APP_Email06:O,VITE_APP_Password06:q}=J,H=async(a,e)=>{const l=new FormData;l.append("file-to-upload",a);const n=`https://vue3-course-api.hexschool.io/v2/api/${B}/admin/upload`;return(await V.post(n,l,{headers:{Authorization:e}})).data.imageUrl},K=({onDelete:a,product:e,loading:l})=>{const n=Math.round((1-e.price/e.origin_price)*100);return s.jsx("div",{className:"col",children:s.jsxs("div",{className:"card h-100 shadow-sm product-card",children:[s.jsx("img",{src:e.imageUrl,alt:e.title,className:`card-img-top ${f["product-card"]}`,style:{height:"250px",objectFit:"cover"}}),s.jsxs("div",{className:"card-body",children:[s.jsx("h5",{className:"card-title",children:e.title}),s.jsx("span",{className:`badge ${e.is_enabled?"bg-success":"bg-secondary"} mb-2`,children:e.is_enabled?"âœ“ è²©å”®ä¸­":"âœ— å·²ä¸‹æž¶"}),s.jsxs("p",{className:"text-muted small mb-2",children:["ðŸ“ ",e.category]}),e.description&&s.jsx("p",{className:"card-text small",children:e.description}),e.content&&s.jsx("p",{className:"card-text text-muted",style:{fontSize:"0.85rem"},children:e.content}),s.jsx("div",{className:"bg-light p-2 rounded mb-3",children:s.jsxs("span",{className:"text-muted small",children:["ðŸ“¦ ",e.unit," Ã— ",e.num]})}),s.jsxs("div",{className:"bg-gradient p-3 rounded text-white mb-3",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[s.jsxs("span",{className:"text-decoration-line-through opacity-75 small",children:["åŽŸåƒ¹ NT$ ",e.origin_price?.toLocaleString()]}),n>0&&s.jsxs("span",{className:"badge bg-white bg-opacity-25 small",children:["çœ ",n,"%"]})]}),s.jsxs("div",{className:"fs-4 fw-bold",children:["NT$ ",e.price?.toLocaleString()]})]}),e.imagesUrl&&e.imagesUrl.length>0&&s.jsxs("div",{className:"border-top pt-3 mb-3",children:[s.jsx("p",{className:"text-muted small fw-bold mb-2",children:"ðŸ–¼ï¸ æ›´å¤šåœ–ç‰‡"}),s.jsx("div",{className:"d-flex gap-2 flex-wrap",children:e.imagesUrl.map((o,r)=>s.jsx("img",{src:o,alt:`${e.title}-${r}`,className:`rounded ${f["gallery-image"]}`,style:{width:"80px",height:"80px",objectFit:"cover",cursor:"pointer"}},r))})]}),s.jsx("div",{className:"border-top pt-3",children:s.jsx("button",{className:"btn btn-danger w-100",onClick:()=>a(e.id,e.title),disabled:l,children:l?"è™•ç†ä¸­...":"ðŸ—‘ï¸ åˆªé™¤ç”¢å“"})})]})]})})},W=({selectedFile:a,previewUrl:e,uploadedImageUrl:l,loading:n,onFileChange:o,onUpload:r})=>s.jsx("div",{className:"card mb-4 shadow-sm",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h3",{className:"card-title",children:"ðŸ“¤ ä¸Šå‚³åœ–ç‰‡"}),s.jsx("p",{className:"text-muted small mb-3",children:"æ”¯æ´æ ¼å¼ï¼šJPGã€JPEGã€PNGï¼Œæª”æ¡ˆå¤§å°é™åˆ¶ 3MB"}),s.jsxs("div",{className:"d-flex gap-3 align-items-center flex-wrap mb-3",children:[s.jsxs("div",{className:"file-input-wrapper",children:[s.jsx("input",{type:"file",className:"form-control d-none",id:"file-upload",accept:".jpg,.jpeg,.png",onChange:o}),s.jsx("label",{htmlFor:"file-upload",className:"btn btn-outline-secondary",children:"ðŸ“ é¸æ“‡æª”æ¡ˆ"})]}),a&&s.jsxs("span",{className:"text-muted small",children:["å·²é¸æ“‡ï¼š",a.name," (",(a.size/1024).toFixed(2)," KB)"]}),s.jsx("button",{className:"btn btn-success",onClick:r,disabled:!a||n,children:n?"ä¸Šå‚³ä¸­...":"â¬†ï¸ ä¸Šå‚³"})]}),e&&s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"text-muted small",children:"é è¦½ï¼š"}),s.jsx("img",{src:e,alt:"é è¦½",className:"img-thumbnail",style:{maxWidth:"200px",maxHeight:"200px"}})]}),l&&s.jsxs("div",{className:"alert alert-success mt-3",children:[s.jsx("p",{className:"small mb-2",children:"âœ… ä¸Šå‚³æˆåŠŸï¼åœ–ç‰‡ç¶²å€ï¼š"}),s.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,readOnly:!0,onClick:d=>d.target.select()})]})]})}),Q=({error:a})=>s.jsxs("div",{className:"alert alert-danger d-flex align-items-center",role:"alert",children:[s.jsx("span",{className:"fs-4 me-2",children:"âš ï¸"}),s.jsxs("span",{children:["éŒ¯èª¤ï¼š",a]})]});function Z(){const a=C(),{products:e,status:l,error:n,isLoggedIn:o,token:r}=L(t=>t.product),[d,h]=m.useState(null),[N,p]=m.useState(null),[w,v]=m.useState(""),[y,x]=m.useState(!1);m.useEffect(()=>{a(D()).unwrap().then(()=>{a(j())}).catch(()=>{a(F({username:O,password:q})).unwrap().then(()=>{a(j())}).catch(t=>{console.error("Login failed:",t)})})},[a]);const P=t=>{const i=t.target.files[0];if(!i)return;if(!["image/jpeg","image/jpg","image/png"].includes(i.type)){alert("âŒ åƒ…æ”¯æ´ JPGã€JPEG æˆ– PNG æ ¼å¼çš„åœ–ç‰‡");return}if(i.size>3*1024*1024){alert("âŒ æª”æ¡ˆå¤§å°ä¸èƒ½è¶…éŽ 3MB");return}h(i);const c=new FileReader;c.onloadend=()=>{p(c.result)},c.readAsDataURL(i)},_=async()=>{if(d){x(!0);try{const t=await H(d,r);v(t),alert("âœ… åœ–ç‰‡ä¸Šå‚³æˆåŠŸï¼"),h(null),p(null)}catch(t){alert("âŒ ä¸Šå‚³å¤±æ•—: "+(t.response?.data?.message||t.message))}finally{x(!1)}}},A=(t,i)=>{confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${i}ã€å—Žï¼Ÿ`)&&a(z(t))},U=()=>{const t=["é›»å­ç”¢å“","æœé£¾é…ä»¶","ç¾Žå¦ä¿é¤Š","é£Ÿå“é£²æ–™","é‹å‹•å¥èº«","å®¶å±…ç”Ÿæ´»","æ›¸ç±æ–‡å…·","çŽ©å…·éŠæˆ²","å¯µç‰©ç”¨å“","æ±½è»Šç”¨å“","æˆ¶å¤–éœ²ç‡Ÿ","æ¨‚å™¨éŸ³éŸ¿","æ‰‹ä½œææ–™","è¾¦å…¬ç”¨å“","æ¸…æ½”ç”¨å“"],i=["å€‹","ä»¶","çµ„","ç›’","åŒ…","ç“¶","é›™","å°","æ”¯","æ¢","å¼µ","æœ¬","è¢‹","ç½","æ¡¶"],g=["https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400","https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400","https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400","https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f?w=400","https://images.unsplash.com/photo-1560343090-f0409e92791a?w=400","https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400","https://images.unsplash.com/photo-1491553895911-0055eca6402d?w=400","https://images.unsplash.com/photo-1585386959984-a4155224a1ad?w=400","https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400","https://images.unsplash.com/photo-1546868871-7041f2a55e12?w=400","https://images.unsplash.com/photo-1484704849700-f032a568e944?w=400","https://images.unsplash.com/photo-1517841905240-472988babdf9?w=400","https://images.unsplash.com/photo-1526947425960-945c6e72858f?w=400","https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400","https://images.unsplash.com/photo-1434494878577-86c23bcb06b9?w=400"],c=t[Math.floor(Math.random()*t.length)],k=i[Math.floor(Math.random()*i.length)],u=Math.floor(Math.random()*5e3)+500,I=Math.floor(Math.random()*40)+10,M=Math.floor(u*(100-I)/100),E=Math.random()>.3?1:0,T=[...g].sort(()=>Math.random()-.5),S=Math.floor(Math.random()*3)+1,b=T.slice(0,S),$={title:`${c}å•†å“_${Date.now()}`,category:c,origin_price:u,price:M,unit:k,description:`é€™æ˜¯ ${c} çš„ç²¾é¸å•†å“ï¼Œå“è³ªä¿è­‰ï¼Œå€¼å¾—æ“æœ‰ï¼`,content:"ç”¢å“ç‰¹è‰²ï¼šé«˜å“è³ªã€è€ç”¨ã€å¯¦æƒ ã€‚",is_enabled:E,imageUrl:b[0],imagesUrl:b};a(G($))};return s.jsxs("div",{className:"container py-5",children:[s.jsxs("div",{className:"text-center mb-5 p-5 rounded-4 text-white position-relative overflow-hidden",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 10px 40px rgba(102, 126, 234, 0.3)"},children:[s.jsxs("div",{className:"position-relative",style:{zIndex:1},children:[s.jsxs("h1",{className:"display-4 fw-bold mb-3",children:[s.jsx("i",{className:"bi bi-cloud-arrow-up me-3"}),"Redux Async Thunk"]}),s.jsx("p",{className:"lead mb-0",children:"çµåˆ Redux Toolkit èˆ‡ Axios é€²è¡Œ API ä¸²æŽ¥"})]}),s.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100",style:{background:"radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%)",zIndex:0}})]}),s.jsx("div",{className:"row mb-5",children:s.jsx("div",{className:"col-12",children:s.jsx("div",{className:"card border-0 shadow-sm",children:s.jsxs("div",{className:"card-body p-4",children:[s.jsxs("h2",{className:"h4 mb-4",children:[s.jsx("i",{className:"bi bi-info-circle me-2 text-primary"}),"Redux Async èªªæ˜Ž"]}),s.jsxs("p",{children:["æœ¬ç¯„ä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨ ",s.jsx("code",{children:"createAsyncThunk"})," è™•ç†éžåŒæ­¥ API è«‹æ±‚ï¼Œä¸¦å°‡ Products ç‹€æ…‹å­˜æ–¼ Store ä¸­ã€‚"]}),s.jsxs("ul",{children:[s.jsxs("li",{children:[s.jsx("strong",{children:"checkLogin:"})," æª¢æŸ¥ Cookie Token é©—è­‰ç‹€æ…‹"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"fetchProducts:"})," å–å¾—é ç«¯ç”¢å“åˆ—è¡¨ï¼ŒStore"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"addProduct / deleteProduct:"})," å‘¼å« API å¾Œ Dispatch æ›´æ–°"]})]})]})})})}),s.jsx("div",{className:"row mb-4",children:s.jsx("div",{className:"col-12",children:s.jsx("div",{className:"card border-0 shadow-sm",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h3",{className:"card-title mb-4",children:[s.jsx("i",{className:"bi bi-code-square me-2"}),"äº’å‹•ç¯„ä¾‹"]}),l==="loading"&&s.jsx(R,{children:s.jsx("b",{children:"è¼‰å…¥ä¸­..."})}),n&&s.jsx(Q,{error:n}),s.jsxs("div",{className:"container mt-2",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3",children:[s.jsx("h1",{className:"text-center flex-grow-1 mb-0",children:"ðŸ›ï¸ ç”¢å“åˆ—è¡¨ (Redux)"}),s.jsx("button",{className:"btn btn-primary btn-lg",onClick:U,disabled:l==="loading",children:l==="loading"?"è™•ç†ä¸­...":"âž• æ–°å¢žç”¢å“"})]}),s.jsx(W,{selectedFile:d,previewUrl:N,uploadedImageUrl:w,loading:y,onFileChange:P,onUpload:_}),s.jsx("div",{className:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4",children:e&&e.map(t=>s.jsx(K,{product:t,onDelete:A,loading:l==="loading"},t.id))})]})]})})})})]})}export{Z as default};
